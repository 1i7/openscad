OpenSCAD human language translation
===================================

For ordinary c++ code, we use GNU gettext (pot->po->mo files) without 
autotools. For the QT .ui files, we also use GNU gettext, by using the 
'-tr' feature of qmake's uic to insert a gettext wrapper into qt's 
generated ui_xxxxx.h files.

For somewhat similar designs, see the source code of projects like celestia, 
stellarium, licq, merkaartor, etc (although they typically use cmake).

Currently the build system does not auto-update anything. The .mo files must
be generated by running the gettext tools: xgettext, msgmerge, and msgfmt.
There is a script included, translation.sh, that automates this process.

File layout:
============

 ./po/*.po - .po files, one per language
 ./po/openscad.pot - .pot template, generated by xgettext
 ./po/POTFILES.in - list of source code files with translatable strings
 ./po/LINGUAS - list of language codes for which .po files exist
 ./src/qtgettext.h - wrapper code between QT and GNU gettext
 ./scripts/translation.sh - simple unix helper script for gettext tools

To translate the strings:
=========================

Use a text editor or special program (poedit or lokalize) to edit the .po file.
( See http://en.opensuse.org/SDB:Localization_work_with_po_files )
Then submit your new .po file as an OpenSCAD github issue or pull request:

https://github.com/openscad/openscad/issues/ 

In the future there might be a site to allow translations in a browser:

https://translations.launchpad.net/openscad 

If all else fails, email the OpenSCAD mailing list with your new .po 
file attached.

To make source code changes:
============================

In .cc files, #include "printutils.h" and change each "text" into 
_("text"). In .ui files, #include "qtgettext.h" first in the .h file 
(see MainWindow.h). Then clean and rebuild to recreate the ui_xxxx.h 
files.

   $ make clean && qmake && make

Now make sure your .cc and ui_xxxx.h files are listed in po/POTFILES.in. 
Then run the script to scan them, and regenerate .pot, .po & .mo files

   $ ./scripts/translate.sh updateall

The new .po files can then be distributed to translators for translation. 
After the translated .po file is obtained, overwrite the old .po and run
the translate.sh updateall script again to regenerate the .mo files.

To add a new language:
======================

First add the language code to file ./po/LINGUAS. Then run msginit, replacing
xx with the two letter language code you want. 

    $ msginit -l xx -o ./po/xx.po -i ./po/openscad.pot

You will now have a new ./po/xx.po file to edit and translate

Testing:
========

Language is determind by environment variables. On unix, for example, to
test French, run this:

   $ LANG=fr ./openscad

